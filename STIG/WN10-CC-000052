<#
.SYNOPSIS
    This PowerShell script ensures Windows 10 is configured to prioritize ECC Curves with longer key lengths first. Requiring ECC curves with longer key lengths to be prioritized, first helps ensure more secure algorithms are used.

.NOTES
    Author          : Sir William
    LinkedIn        : linkedin.com/in/-----------/
    GitHub          : https://github.com/sirwilliam1
    Date Created    : 2025-09-10
    Last Modified   : 2025-09-10
    Version         : 1.0
    CVEs            : N/A
    Plugin IDs      : N/A
    STIG-ID         : WN10-CC-000052 

.TESTED ON
    Date(s) Tested  : 
    Tested By       : 
    Systems Tested  : 
    PowerShell Ver. : 

.USAGE
    Put any usage instructions here.
    Example syntax:
    PS C:\> .\STIG-ID-WN10-CC-000052.ps12
#>

# Define the registry path
$regPath = "HKLM:\SOFTWARE\Policies\Microsoft\Cryptography\Configuration\SSL\00010002"

# Create the registry key if it doesn't exist
if (-not (Test-Path $regPath)) {
    New-Item -Path $regPath -Force
}

# Define the ECC curves in order of preference
$eccCurves = @("NistP384", "NistP256")

# Set the REG_MULTI_SZ value
New-ItemProperty -Path $regPath -Name "EccCurves" -Value $eccCurves -PropertyType MultiString -Force

Write-Output "ECC curve prioritization has been successfully configured."
