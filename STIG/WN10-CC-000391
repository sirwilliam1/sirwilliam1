<#
.SYNOPSIS
    This PowerShell script ensures that Internet Explorer must be disabled for Windows 10. Internet Explorer 11 (IE11) is no longer supported on Windows 10 semi-annual channel.

.NOTES
    Author          : Sir William
    LinkedIn        : linkedin.com/in/-----------/
    GitHub          : https://github.com/sirwilliam1
    Date Created    : 2025-09-13
    Last Modified   : 2025-09-13
    Version         : 1.0
    CVEs            : N/A
    Plugin IDs      : N/A
    STIG-ID         : WN10-CC-000391

.TESTED ON
    Date(s) Tested  : 
    Tested By       : 
    Systems Tested  : 
    PowerShell Ver. : 

.USAGE
    Put any usage instructions here.
    Example syntax:
    PS C:\> .\STIG-ID-WN10-CC-000391.ps25
#>

<#
.SYNOPSIS
    DISA STIG WN10-CC-000391 Compliance Check and Remediation

.DESCRIPTION
    - Checks if IE11 is installed/enabled.
    - If enabled, logs a finding and disables IE11.
    - If disabled, logs compliance.
#>

$featureName = "Internet-Explorer-Optional-amd64"

Write-Output "Checking Internet Explorer 11 installation state..."

try {
    $ieFeature = Get-WindowsOptionalFeature -Online -FeatureName $featureName -ErrorAction Stop
}
catch {
    Write-Output "Feature $featureName not found. IE11 is not present on this system."
    exit 0
}

switch ($ieFeature.State.ToString()) {
    "Enabled" {
        Write-Warning "FINDING: Internet Explorer 11 is ENABLED. Remediating now..."

        Disable-WindowsOptionalFeature -Online -FeatureName $featureName -NoRestart -ErrorAction SilentlyContinue

        Write-Output "Internet Explorer 11 has been disabled. A restart may be required for full effect."
    }
    "Disabled" {
        Write-Output "PASS: Internet Explorer 11 is already disabled. System is compliant."
    }
    default {
        Write-Output "Internet Explorer 11 feature state: $($ieFeature.State)"
    }
}
